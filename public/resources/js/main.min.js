!function(t,e,n){"use strict";function a(){var t=i.get(Math.floor(Math.random()*i.length));t.currentTime=0,t.play()}var i,o=function(e){this.$imageContainer=o.$imageContainerCache.clone().data("Cat",this).on("mousedown",this.imageContainerOnMouseDown).on("mouseup",this.imageContainerOnMouseUp),this.$image=t(".image",this.$imageContainer),this.$restartButton=t(".restart-button",this.$imageContainer).on("click",this.restartButtonOnClick).on("mousedown mouseup",function(t){t.stopPropagation()}),this.$loadingPercentage=t(".loading-percentage",this.$imageContainer),this.$clickCount=t(".click-count",this.$imageContainer),this.clickCount=0,this.onMouseDown=t.isFunction(e)?e:t.noop,this.initialize()};o.prototype.imageContainerOnMouseDown=function(){var e=t(this).data("Cat");e.$imageContainer.addClass("clicked"),e.$clickCount.addClass("image-clicked").text(++e.clickCount),e.onMouseDown()},o.prototype.imageContainerOnMouseUp=function(){var e=t(this).data("Cat");e.$imageContainer.removeClass("clicked"),e.$clickCount.removeClass("image-clicked")},o.prototype.restartButtonOnClick=function(e){var n=t(this).parent().data("Cat");e.stopPropagation(),n.$restartButton.hasClass("loading")||n.initialize()},o.prototype.$getImageContainer=function(){return this.$imageContainer},o.prototype.initialize=function(){var t=this,e=t.$restartButton.addClass("loading"),n=t.$loadingPercentage.addClass("show"),a=t.$image,i=t.$clickCount;t.clickCount=0;var o=new XMLHttpRequest;o.onprogress=function(t){t.lengthComputable&&n.text(Math.round(t.loaded/t.total*100)+"%")},o.onerror=function(){alert("An error occurred while fetching a cure Cat image!\nRetrying..."),t.initialize()},o.onreadystatechange=function(){if(o.readyState===XMLHttpRequest.DONE&&200===o.status){var t=window.URL||window.webkitURL;a.css("background-image","url("+t.createObjectURL(o.response)+")"),i.text("0"),e.removeClass("loading"),n.removeClass("show").text("0%")}},o.responseType="blob",o.open("GET","https://thecatapi.com/api/images/get?api_key=MTgyMTA2&format=src&category=dream"),o.send()},o.$imageContainerCache=t('<div class="image-container">\n    <div class="image-wrapper">\n        <div class="image"></div>\n    </div>\n    <div class="fa fa-repeat restart-button">\n        <div class="loading-percentage">0%</div>\n    </div>\n    <div class="click-count">0</div>\n</div>\n'),t(function(){i=t(".click-sound",n),i.each(function(t){i.get(t).volume=.2});var e=[new o(a),new o(a),new o(a)];t("#cat-container",n).append(e.map(function(t){return t.$getImageContainer()}))})}(jQuery,window,document);
