!function(i,t,n,a){"use strict";function e(){var i=o.get(Math.floor(Math.random()*o.length));i.currentTime=0,i.play()}var o,c=function(t){this.$imageContainer=c.$imageContainerCache.clone().data("Cat",this).on("click",c.imageContainerOnClick),this.$image=i(".image",this.$imageContainer),this.$resetButton=i(".reset-button",this.$imageContainer).on("click",c.resetButtonOnClick).on("mousedown mouseup",function(i){i.stopPropagation()}),this.$clickCount=i(".click-count",this.$imageContainer),this.clickCount=0,this.onClick=i.isFunction(t)?t:i.noop,this.initialize()};c.$imageContainerCache=i('<div class="image-container">\n    <div class="image-wrapper">\n        <div class="image"></div>\n    </div>\n    <div class="fa fa-repeat reset-button"></div>\n    <div class="click-count">0</div>\n</div>\n'),c.imageContainerOnClick=function(){var t=i(this).data("Cat");t.$clickCount.addClass("image-clicked").text(++t.clickCount),t.onClick()},c.resetButtonOnClick=function(t){var n=i(this).parent().data("Cat");t.stopPropagation(),n.$resetButton.hasClass("loading")||n.initialize()},c.getImage=function(i,t){var n=new XMLHttpRequest;n.onerror=t,n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE&&200===n.status){var t=window.URL||window.webkitURL;i(t.createObjectURL(n.response))}},n.responseType="blob",n.open("GET","https://thecatapi.com/api/images/get?api_key=MTgyMTA2&format=src&category=dream"),n.send()},c.prototype.initialize=function(){var i=this;i.clickCount=0,i.$clickCount.text("0")};var s=function(t,n){this.imageURL=void 0,this.cat=t,this.$imageContainer=s.$thumbnailCache.clone().data("CatThumbnail",this).on("click",s.imageContainerOnClick),this.$image=i(".image",this.$imageContainer),this.$resetButton=i(".reset-button",this.$imageContainer).on("click",s.resetButtonOnClick).on("mousedown mouseup",function(i){i.stopPropagation()}),this.initialize(n)};s.imageContainerOnClick=function(){var t=i(this).data("CatThumbnail");t.cat.$image.css("background-image","url("+t.imageURL+")")},s.resetButtonOnClick=function(){var t=i(this).parent().data("CatThumbnail");event.stopPropagation(),t.$resetButton.hasClass("loading")||t.initialize()},s.prototype.initialize=function(t){var n=this,a=n.$resetButton.addClass("loading"),e=n.$image;c.getImage(function(o){n.imageURL=o,e.css("background-image","url("+o+")"),a.removeClass("loading"),i.isFunction(t)&&t(n)},function(){alert("An error occurred while fetching a cure Cat image!\nRetrying..."),n.initialize()})},s.$thumbnailCache=i('<div class="thumbnail image-container">\n    <div class="image-wrapper">\n        <div class="image"></div>\n    </div>\n    <div class="fa fa-repeat reset-button"></div>\n</div>'),i(function(){o=i(".click-sound",n),o.each(function(i){o.get(i).volume=.2});var t=new c(e),a=[new s(t,function(i){i.$imageContainer.trigger("click")}),new s(t),new s(t),new s(t),new s(t)];i("#cat-thumbnail-container",n).append(a.map(function(i){return i.$imageContainer})),i("#cat-container",n).append(t.$imageContainer)})}(jQuery,window,document);
